/*! v2.8.0-fec6cdf5, 2018-06-11T22:13:34Z */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a)}return e(a,[{key:"extend",value:function(a,b){if(a){var c=!!b&&b.override,d=!!b&&b.publicOnly;for(var e in a)!a.hasOwnProperty(e)||this[e]&&!c||d&&-1===a[e].indexOf("public_")||(this[e]=a[e])}}}]),a}();c.default=f,b.exports=c.default},{}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}},h=a(1),i=d(h),j=function(a){function b(){e(this,b),g(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.FRAGMENT_INFO_LOADING_COMPLETED="fragmentInfoLoadingCompleted"}return f(b,a),b}(i.default),k=new j;c.default=k,b.exports=c.default},{1:1}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){t=J.getLogger(s)}function c(){w=!1,A=null,B=null,C=0,D=NaN,E.registerExternalController(s),x=E.getType(),u=E.getFragmentModel(),v=E.getIndexHandler()}function d(){return E.getRepresentationController().getCurrentRepresentation()}function e(a){u.executeRequest(a)}function f(a){return a&&a.url&&(a.url=a.url.replace("Fragments","FragmentInfo"),a.type="FragmentInfoSegment"),a}function h(a){if(null!==a&&a.action===a.ACTION_COMPLETE)return void o();if(null!==a){if(z=a.startTime+a.duration,a=f(a),E.getFragmentModel().isFragmentLoadedOrPending(a))return a=v.getNextSegmentRequest(d()),void h(a);t.debug("onFragmentRequest "+a.url),e(a)}else t.debug("bufferFragmentInfo failed")}function j(){var a=void 0;if(w){t.debug("Start buffering process..."),a=z,t.debug("LoadNextFragment for time: "+a);var b=d();h(v.getSegmentRequestForTime(b,a))}}function k(a){var b=Math.round(Math.min(1e3*a,2e3));t.debug("Check buffer delta = "+b+" ms"),clearTimeout(y),y=setTimeout(function(){y=null,j()},b)}function l(a){if(a.streamProcessor===E){var b=a.fragmentInfo.request,c=void 0,d=void 0;if(!a.fragmentInfo.response)return void t.error("Load error",b.url);D=b.duration,t.debug("FragmentInfo loaded ",b.url);try{(0,i.default)(r).create({metricsModel:G,playbackController:H,ISOBoxer:I,debug:J}).updateSegmentList(a.fragmentInfo,E),c=((new Date).getTime()-A)/1e3,d=z+D-B,C=d-c>0?d-c:0,k(C)}catch(a){t.fatal("Internal error while processing fragment info segment ")}}}function m(){w&&(A=(new Date).getTime(),B=z,t.debug("startPlayback"),j.call(this))}function n(){var a=void 0;if(!0!==w){F.on(g.default.FRAGMENT_INFO_LOADING_COMPLETED,l,s),w=!0,t.debug("Do start");var b=d();a=b.segments,a&&a.length>0?(z=a[a.length-1].presentationStartTime-a[a.length-1].duration,m()):(v.updateSegmentList(b),a=b.segments,a&&a.length>0&&(z=a[a.length-1].presentationStartTime-a[a.length-1].duration),m())}}function o(){w&&(t.debug("Do stop"),F.off(g.default.FRAGMENT_INFO_LOADING_COMPLETED,l,s),clearTimeout(y),w=!1,A=null,B=null)}function p(){return x}function q(){o(),E.unregisterExternalController(s)}a=a||{};var r=this.context,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0,A=void 0,B=void 0,C=void 0,D=void 0,E=a.streamProcessor,F=a.eventBus,G=a.metricsModel,H=a.playbackController,I=a.ISOBoxer,J=a.debug;return s={initialize:c,controllerType:"MssFragmentInfoController",start:n,getType:p,reset:q},b(),s}Object.defineProperty(c,"__esModule",{value:!0});var f=a(2),g=d(f),h=a(4),i=d(h);e.__dashjs_factory_name="MssFragmentInfoController",c.default=dashjs.FactoryMaker.getClassFactory(e),b.exports=c.default},{2:2,4:4}],4:[function(a,b,c){"use strict";function d(a){function b(){i=n.getLogger(h)}function c(a,b,c,e){var f=e.getRepresentationController(),g=f.getCurrentRepresentation(),h=e.getIndexHandler(),j=g.adaptation.period.mpd.manifest,k=j.Period_asArray[g.adaptation.period.index].AdaptationSet_asArray[g.adaptation.index],m=k.SegmentTemplate.timescale;if("dynamic"===j.type){if(!b)return void l.mssError("MSS_NO_TFRF : Missing tfrf in live media segment");var n=k.SegmentTemplate.SegmentTimeline.S,o=b.entry,p=void 0,q=void 0,r=null,s=0,t=null,u=void 0;if(0!==o.length){if(p=o[0],q=n[n.length-1].tManifest?parseFloat(n[n.length-1].tManifest):n[n.length-1].t,p.fragment_absolute_time<=q)return u={start:n[0].t/k.SegmentTemplate.timescale,end:c.baseMediaDecodeTime/k.SegmentTemplate.timescale+a.duration},void d(a.mediaType,u,e.getStreamInfo().manifestInfo);if(i.debug("Add new segment - t = ",p.fragment_absolute_time/m),r={},r.t=p.fragment_absolute_time,r.d=p.fragment_duration,n.push(r),j.timeShiftBufferDepth&&j.timeShiftBufferDepth>0){for(r=n[n.length-1],s=r.t,t=s-j.timeShiftBufferDepth*m,r=n[0];r.t<t;)i.debug("Remove segment  - t = "+r.t/m),n.splice(0,1),r=n[0];u={start:n[0].t/k.SegmentTemplate.timescale,end:c.baseMediaDecodeTime/k.SegmentTemplate.timescale+a.duration},d(a.mediaType,u,e.getStreamInfo().manifestInfo)}h.updateSegmentList(g)}}}function d(a,b,c){var d=j.getMetricsFor(a).DVRInfo;d&&(0===d.length||d.length>0&&b.end>d[d.length-1].range.end)&&(i.debug("Update DVR Infos ["+b.start+" - "+b.end+"]"),j.addDVRInfo(a,k.getTime(),c,b))}function e(a,b){var c=8,d=0;for(d=0;d<a.boxes.length;d++){if(a.boxes[d].type===b)return c;c+=a.boxes[d].size}return c}function f(a,b){var d=void 0,f=m.parseBuffer(a.response),g=f.fetch("tfhd");g.track_ID=a.request.mediaInfo.index+1;var h=f.fetch("tfdt"),i=f.fetch("traf");null===h&&(h=m.createFullBox("tfdt",i,g),h.version=1,h.flags=0,h.baseMediaDecodeTime=Math.floor(a.request.startTime*a.request.timescale));var j=f.fetch("trun"),k=f.fetch("tfxd");k&&(k._parent.boxes.splice(k._parent.boxes.indexOf(k),1),k=null);var l=f.fetch("tfrf");c(a.request,l,h,b),l&&(l._parent.boxes.splice(l._parent.boxes.indexOf(l),1),l=null);var n=f.fetch("sepiff");if(null!==n){n.type="senc",n.usertype=void 0;var o=f.fetch("saio");if(null===o){o=m.createFullBox("saio",i),o.version=0,o.flags=0,o.entry_count=1,o.offset=[0];var p=m.createFullBox("saiz",i);if(p.version=0,p.flags=0,p.sample_count=n.sample_count,p.default_sample_info_size=0,p.sample_info_size=[],2&n.flags)for(d=0;d<n.sample_count;d+=1)p.sample_info_size[d]=10+6*n.entry[d].NumberOfEntries;else p.default_sample_info_size=8}}g.flags&=16777214,g.flags|=131072,j.flags|=1;var q=f.fetch("moof"),r=q.getLength();j.data_offset=r+8;var s=f.fetch("saio");if(null!==s){var t=e(q,"traf"),u=e(i,"senc");s.offset[0]=t+u+16}a.response=f.write()}function g(a,b){if(!a.response)throw new Error("e.response parameter is missing");var d=m.parseBuffer(a.response),e=d.fetch("tfhd");e.track_ID=a.request.mediaInfo.index+1;var f=d.fetch("tfdt"),g=d.fetch("traf");null===f&&(f=m.createFullBox("tfdt",g,e),f.version=1,f.flags=0,f.baseMediaDecodeTime=Math.floor(a.request.startTime*a.request.timescale));var h=d.fetch("tfrf");c(a.request,h,f,b),h&&(h._parent.boxes.splice(h._parent.boxes.indexOf(h),1),h=null)}a=a||{};var h=void 0,i=void 0,j=a.metricsModel,k=a.playbackController,l=a.errHandler,m=a.ISOBoxer,n=a.debug;return h={convertFragment:f,updateSegmentList:g},b(),h}Object.defineProperty(c,"__esModule",{value:!0}),d.__dashjs_factory_name="MssFragmentMoofProcessor",c.default=dashjs.FactoryMaker.getClassFactory(d),b.exports=c.default},{}],5:[function(a,b,c){"use strict";function d(a){function b(a){var b=C.createBox("ftyp",a);return b.major_brand="iso6",b.minor_version=1,b.compatible_brands=[],b.compatible_brands[0]="isom",b.compatible_brands[1]="iso6",b.compatible_brands[2]="msdh",b}function c(a){var b=C.createBox("moov",a);d(b);var c=C.createBox("trak",b);e(c);var l=C.createBox("mdia",c);f(l),g(l);var m=C.createBox("minf",l);switch(F.type){case B.VIDEO:h(m);break;case B.AUDIO:i(m)}j(C.createBox("dinf",m));var n=C.createBox("stbl",m);(C.createFullBox("stts",n)._data=[0,0,0,0,0,0,0,0],C.createFullBox("stsc",n)._data=[0,0,0,0,0,0,0,0],C.createFullBox("stco",n)._data=[0,0,0,0,0,0,0,0],C.createFullBox("stsz",n)._data=[0,0,0,0,0,0,0,0,0,0,0,0],k(n),v(C.createBox("mvex",b)),H&&D)&&t(b,D.getSupportedKeySystemsFromContentProtection(H))}function d(a){var b=C.createFullBox("mvhd",a);return b.version=1,b.creation_time=0,b.modification_time=0,b.timescale=I,b.duration=Math.round(E.duration*I),b.rate=1,b.volume=1,b.reserved1=0,b.reserved2=[0,0],b.matrix=[1,0,0,0,1,0,0,0,16384],b.pre_defined=[0,0,0,0,0,0],b.next_track_ID=J+1,b}function e(a){var b=C.createFullBox("tkhd",a);return b.version=1,b.flags=7,b.creation_time=0,b.modification_time=0,b.track_ID=J,b.reserved1=0,b.duration=Math.round(E.duration*I),b.reserved2=[0,0],b.layer=0,b.alternate_group=0,b.volume=1,b.reserved3=0,b.matrix=[1,0,0,0,1,0,0,0,16384],b.width=G.width,b.height=G.height,b}function f(a){var b=C.createFullBox("mdhd",a);return b.version=1,b.creation_time=0,b.modification_time=0,b.timescale=I,b.duration=Math.round(E.duration*I),b.language=F.lang||"und",b.pre_defined=0,b}function g(a){var b=C.createFullBox("hdlr",a);switch(b.pre_defined=0,F.type){case B.VIDEO:b.handler_type="vide";break;case B.AUDIO:b.handler_type="soun";break;default:b.handler_type="meta"}return b.name=G.id,b.reserved=[0,0,0],b}function h(a){var b=C.createFullBox("vmhd",a);return b.flags=1,b.graphicsmode=0,b.opcolor=[0,0,0],b}function i(a){var b=C.createFullBox("smhd",a);return b.flags=1,b.balance=0,b.reserved=0,b}function j(a){var b=C.createFullBox("dref",a);b.entry_count=1,b.entries=[];var c=C.createFullBox("url ",b,!1);return c.location="",c.flags=1,b.entries.push(c),b}function k(a){var b=C.createFullBox("stsd",a);switch(b.entries=[],F.type){case B.VIDEO:case B.AUDIO:b.entries.push(l(b))}return b.entry_count=b.entries.length,b}function l(a){var b=G.codecs.substring(0,G.codecs.indexOf("."));switch(b){case"avc1":return m(a,b);case"mp4a":return o(a,b);default:throw{name:"Unsupported codec",message:"Unsupported codec",data:{codec:b}}}}function m(a,b){var c=void 0;if(c=H?C.createBox("encv",a,!1):C.createBox("avc1",a,!1),c.reserved1=[0,0,0,0,0,0],c.data_reference_index=1,c.pre_defined1=0,c.reserved2=0,c.pre_defined2=[0,0,0],c.height=G.height,c.width=G.width,c.horizresolution=72,c.vertresolution=72,c.reserved3=0,c.frame_count=1,c.compressorname=[10,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c.depth=24,c.pre_defined3=65535,c.config=n(),H){var d=C.createBox("sinf",c);q(d,b),r(d),s(d)}return c}function n(){for(var a=null,b=15,c=[],d=[],e=0,f=0,g=0,h=G.codecPrivateData.split("00000001").slice(1),i=void 0,j=0;j<h.length;j++)switch(i=w(h[j]),31&i[0]){case z:c.push(i),b+=i.length+2;break;case A:d.push(i),b+=i.length+2}c.length>0&&(e=c[0][1],g=c[0][2],f=c[0][3]),a=new Uint8Array(b);var k=0;a[k++]=(4278190080&b)>>24,a[k++]=(16711680&b)>>16,a[k++]=(65280&b)>>8,a[k++]=255&b,a.set([97,118,99,67],k),k+=4,a[k++]=1,a[k++]=e,a[k++]=g,a[k++]=f,a[k++]=255,a[k++]=224|c.length;for(var l=0;l<c.length;l++)a[k++]=(65280&c[l].length)>>8,a[k++]=255&c[l].length,a.set(c[l],k),k+=c[l].length;a[k++]=d.length;for(var l=0;l<d.length;l++)a[k++]=(65280&d[l].length)>>8,a[k++]=255&d[l].length,a.set(d[l],k),k+=d[l].length;return a}function o(a,b){var c=void 0;if(c=H?C.createBox("enca",a,!1):C.createBox("mp4a",a,!1),c.reserved1=[0,0,0,0,0,0],c.data_reference_index=1,c.reserved2=[0,0],c.channelcount=G.audioChannels,c.samplesize=16,c.pre_defined=0,c.reserved_3=0,c.samplerate=G.audioSamplingRate<<16,c.esds=p(),H){var d=C.createBox("sinf",c);q(d,b),r(d),s(d)}return c}function p(){var a=w(G.codecPrivateData),b=34+a.length,c=new Uint8Array(b),d=0;return c[d++]=(4278190080&b)>>24,c[d++]=(16711680&b)>>16,c[d++]=(65280&b)>>8,c[d++]=255&b,c.set([101,115,100,115],d),d+=4,c.set([0,0,0,0],d),d+=4,c[d++]=3,c[d++]=20+a.length,c[d++]=(65280&J)>>8,c[d++]=255&J,c[d++]=0,c[d++]=4,c[d++]=15+a.length,c[d++]=64,c[d]=20,c[d]|=0,c[d++]|=1,c[d++]=255,c[d++]=255,c[d++]=255,c[d++]=(4278190080&G.bandwidth)>>24,c[d++]=(16711680&G.bandwidth)>>16,c[d++]=(65280&G.bandwidth)>>8,c[d++]=255&G.bandwidth,c[d++]=(4278190080&G.bandwidth)>>24,c[d++]=(16711680&G.bandwidth)>>16,c[d++]=(65280&G.bandwidth)>>8,c[d++]=255&G.bandwidth,c[d++]=5,c[d++]=a.length,c.set(a,d),c}function q(a,b){C.createBox("frma",a).data_format=x(b)}function r(a){var b=C.createFullBox("schm",a);b.flags=0,b.version=0,b.scheme_type=1667591779,b.scheme_version=65536}function s(a){u(C.createBox("schi",a))}function t(a,b){var c=void 0,d=void 0,e=void 0,f=void 0;for(e=0;e<b.length;e+=1)c=b[e].initData,f=C.parseBuffer(c),(d=f.fetch("pssh"))&&C.Utils.appendBox(a,d)}function u(a){var b=C.createFullBox("tenc",a);b.flags=0,b.version=0,b.default_IsEncrypted=1,b.default_IV_size=8,b.default_KID=H&&H.length>0&&H[0]["cenc:default_KID"]?H[0]["cenc:default_KID"]:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}function v(a){var b=C.createFullBox("trex",a);return b.track_ID=J,b.default_sample_description_index=1,b.default_sample_duration=0,b.default_sample_size=0,b.default_sample_flags=0,b}function w(a){var b=new Uint8Array(a.length/2),c=void 0;for(c=0;c<a.length/2;c+=1)b[c]=parseInt(""+a[2*c]+a[2*c+1],16);return b}function x(a){var b=0,c=void 0;for(c=0;c<a.length;c+=1)b|=a.charCodeAt(c)<<8*(a.length-c-1);return b}function y(a){if(a&&a.adaptation){var d=void 0;return G=a,F=G.adaptation,E=F.period,J=F.index+1,H=E.mpd.manifest.Period_asArray[E.index].AdaptationSet_asArray[F.index].ContentProtection,I=E.mpd.manifest.Period_asArray[E.index].AdaptationSet_asArray[F.index].SegmentTemplate.timescale,d=C.createFile(),b(d),c(d),d.write()}}a=a||{};var z=7,A=8,B=a.constants,C=a.ISOBoxer,D=a.protectionController,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,J=void 0;return{generateMoov:y}}Object.defineProperty(c,"__esModule",{value:!0}),d.__dashjs_factory_name="MssFragmentMoovProcessor",c.default=dashjs.FactoryMaker.getClassFactory(d),b.exports=c.default},{}],6:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){return a.length===b.length&&a.every(function(a,c){return a===b[c]})}function f(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)}function g(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)}function h(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("IV_size","uint",8),this._procEntries("entry",this.sample_count,function(a){this._procEntryField(a,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(a,"NumberOfEntries","uint",16),this._procSubEntries(a,"clearAndCryptedData",a.NumberOfEntries,function(a){this._procEntryField(a,"BytesOfClearData","uint",16),this._procEntryField(a,"BytesOfEncryptedData","uint",32)}))})}function i(){var a=[109,29,155,5,66,213,68,230,128,226,20,29,175,247,87,178],b=[212,128,126,242,202,57,70,149,142,84,38,203,158,70,167,159],c=[162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244];e(this.usertype,a)&&(this._procFullBox(),this._parsing&&(this.type="tfxd"),this._procField("fragment_absolute_time","uint",1===this.version?64:32),this._procField("fragment_duration","uint",1===this.version?64:32)),e(this.usertype,b)&&(this._procFullBox(),this._parsing&&(this.type="tfrf"),this._procField("fragment_count","uint",8),this._procEntries("entry",this.fragment_count,function(a){this._procEntryField(a,"fragment_absolute_time","uint",1===this.version?64:32),this._procEntryField(a,"fragment_duration","uint",1===this.version?64:32)})),e(this.usertype,c)&&(this._parsing&&(this.type="sepiff"),h.call(this))}function j(a){function b(){q.addBoxProcessor("uuid",i),q.addBoxProcessor("saio",f),q.addBoxProcessor("saiz",g),q.addBoxProcessor("senc",h)}function c(b){return(0,n.default)(e).create({protectionController:o,constants:a.constants,ISOBoxer:a.ISOBoxer}).generateMoov(b)}function d(b,c){if(!b||!b.request||!b.response)throw new Error("e parameter is missing or malformed");var d=b.request;if("MediaSegment"===d.type){(0,l.default)(e).create({metricsModel:j,playbackController:k,ISOBoxer:q,debug:r,errHandler:a.errHandler}).convertFragment(b,c)}else"FragmentInfoSegment"===d.type&&(m.trigger(p.default.FRAGMENT_INFO_LOADING_COMPLETED,{fragmentInfo:b,streamProcessor:c}),b.sender=null)}a=a||{};var e=this.context,j=a.metricsModel,k=a.playbackController,m=a.eventBus,o=a.protectionController,q=a.ISOBoxer,r=a.debug,s=void 0;return s={generateMoov:c,processFragment:d},b(),s}Object.defineProperty(c,"__esModule",{value:!0});var k=a(4),l=d(k),m=a(5),n=d(m),o=a(2),p=d(o);j.__dashjs_factory_name="MssFragmentProcessor",c.default=dashjs.FactoryMaker.getClassFactory(j),b.exports=c.default},{2:2,4:4,5:5}],7:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){function b(){}function c(a){var b=a.sender.getStreamProcessor(),c=new i.default,e=b.getRepresentationController(),f=e.getCurrentRepresentation(),g=void 0;g=f.adaptation.period,c.mediaType=f.adaptation.type,c.type=t,c.range=f.range,g.start,c.quality=f.index,c.mediaInfo=b.getMediaInfo(),c.representationId=f.id;var h=d(c,b.getStreamInfo().id,a.type!==r.FRAGMENT_LOADING_PROGRESS);h.bytes=x.generateMoov(f),q.trigger(r.INIT_FRAGMENT_LOADED,{chunk:h,fragmentModel:b.getFragmentModel()}),a.sender=null}function d(a,b,c){var d=new g.default;return d.streamId=b,d.mediaInfo=a.mediaInfo,d.segmentType=a.type,d.start=a.startTime,d.duration=a.duration,d.end=d.start+d.duration,d.index=a.index,d.quality=a.quality,d.representationId=a.representationId,d.endFragment=c,d}function e(a){if(!a.error){var b=a.sender.getStreamProcessor();x.processFragment(a,b)}}function f(){if(v.getIsDynamic()&&0!==v.getTime()){var b=v.getStreamController();if(b){b.getActiveStreamProcessors().forEach(function(b){if(b.getType()===s.VIDEO||b.getType()===s.AUDIO||b.getType()===s.FRAGMENTED_TEXT){var c=void 0,d=!1,e=b.getExternalControllers();for(c=0;c<e.length;c++)e[c].controllerType&&"MssFragmentInfoController"===e[c].controllerType&&(d=!0);if(!d){var f=(0,k.default)(p).create({streamProcessor:b,eventBus:q,metricsModel:u,playbackController:v,ISOBoxer:a.ISOBoxer,debug:a.debug});f.initialize(),f.start()}}})}}}function h(a){if(a&&a.data)for(;-1!==a.data.indexOf("http://www.w3.org/2006/10/ttaf1");)a.data=a.data.replace("http://www.w3.org/2006/10/ttaf1","http://www.w3.org/ns/ttml")}function j(){q.on(r.INIT_REQUESTED,c,z,dashjs.FactoryMaker.getSingletonFactoryByName(q.getClassName()).EVENT_PRIORITY_HIGH),q.on(r.PLAYBACK_SEEK_ASKED,f,z,dashjs.FactoryMaker.getSingletonFactoryByName(q.getClassName()).EVENT_PRIORITY_HIGH),q.on(r.FRAGMENT_LOADING_COMPLETED,e,z,dashjs.FactoryMaker.getSingletonFactoryByName(q.getClassName()).EVENT_PRIORITY_HIGH),q.on(r.TTML_TO_PARSE,h,z)}function l(){q.off(r.INIT_REQUESTED,c,this),q.off(r.PLAYBACK_SEEK_ASKED,f,this),q.off(r.FRAGMENT_LOADING_COMPLETED,e,this),q.off(r.TTML_TO_PARSE,h,this)}function n(){return y=(0,o.default)(p).create(a)}a=a||{};var p=this.context,q=a.eventBus,r=a.events,s=a.constants,t=a.initSegmentType,u=a.metricsModel,v=a.playbackController,w=a.protectionController,x=(0,m.default)(p).create({metricsModel:u,playbackController:v,protectionController:w,eventBus:q,constants:s,ISOBoxer:a.ISOBoxer,debug:a.debug,errHandler:a.errHandler}),y=void 0,z=void 0;return z={reset:l,createMssParser:n,registerEvents:j},b(),z}Object.defineProperty(c,"__esModule",{value:!0});var f=a(10),g=d(f),h=a(11),i=d(h),j=a(3),k=d(j),l=a(6),m=d(l),n=a(9),o=d(n);e.__dashjs_factory_name="MssHandler",c.default=dashjs.FactoryMaker.getClassFactory(e),b.exports=c.default},{10:10,11:11,3:3,6:6,9:9}],8:[function(a,b,c){(function(b){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a(7),f=d(e),g="undefined"!=typeof window&&window||b,h=g.dashjs;h||(h=g.dashjs={}),h.MssHandler=f.default,c.default=h,c.MssHandler=f.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{7:7}],9:[function(a,b,c){"use strict";function d(a){function b(){E=v.getLogger(D),F=a.mediaPlayerModel}function c(a,b){var c={},e=void 0,f=void 0;c.AdaptationSet_asArray=[],e=a.getElementsByTagName("StreamIndex");for(var g=0;g<e.length;g++)null!==(f=d(e[g],b))&&c.AdaptationSet_asArray.push(f);return c.AdaptationSet_asArray.length>0&&(c.AdaptationSet=c.AdaptationSet_asArray.length>1?c.AdaptationSet_asArray:c.AdaptationSet_asArray[0]),c}function d(a,b){var c={},d=[],f=void 0,g=void 0,i=void 0,j=void 0;if(c.id=a.getAttribute("Name")?a.getAttribute("Name"):a.getAttribute("Type"),c.contentType=a.getAttribute("Type"),c.lang=a.getAttribute("Language")||"und",c.mimeType=C[c.contentType],c.subType=a.getAttribute("Subtype"),c.maxWidth=a.getAttribute("MaxWidth"),c.maxHeight=a.getAttribute("MaxHeight"),c.subType){if(z[c.subType]){var k={schemeIdUri:"urn:mpeg:dash:role:2011",value:z[c.subType]};c.Role=k,c.Role_asArray=[k]}if(A[c.subType]){var l={schemeIdUri:"urn:tva:metadata:cs:AudioPurposeCS:2007",value:A[c.subType]};c.Accessibility=l,c.Accessibility_asArray=[l]}}for(f=h(a,b),g=a.getElementsByTagName("QualityLevel"),j=0;j<g.length;j++)g[j].BaseURL=c.BaseURL,g[j].mimeType=c.mimeType,g[j].Id=c.id+"_"+g[j].getAttribute("Index"),null!==(i=e(g[j],a))&&(i.SegmentTemplate=f,d.push(i));return 0===d.length?null:(c.Representation=d.length>1?d:d[0],c.Representation_asArray=d,c.SegmentTemplate=f,f.SegmentTimeline.S_asArray,c)}function e(a,b){var c={},d=b.getAttribute("Type"),e=null;if(c.id=a.Id,c.bandwidth=parseInt(a.getAttribute("Bitrate"),10),c.mimeType=a.mimeType,c.width=parseInt(a.getAttribute("MaxWidth"),10),c.height=parseInt(a.getAttribute("MaxHeight"),10),e=a.getAttribute("FourCC"),null!==e&&""!==e||(e=b.getAttribute("FourCC")),null===e||""===e)if("audio"===d)e="AAC";else if("video"===d)return E.debug('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;return-1===y.indexOf(e.toUpperCase())?(E.warn("Codec not supported: "+e),null):("H264"===e||"AVC1"===e?c.codecs=f(a):e.indexOf("AAC")>=0?(c.codecs=g(a,e),c.audioSamplingRate=parseInt(a.getAttribute("SamplingRate"),10),c.audioChannels=parseInt(a.getAttribute("Channels"),10)):(e.indexOf("TTML")||e.indexOf("DFXP"))&&(c.codecs=w.STPP),c.codecPrivateData=""+a.getAttribute("CodecPrivateData"),c.BaseURL=a.BaseURL,c)}function f(a){var b=a.getAttribute("CodecPrivateData").toString(),c=void 0;return c=/00000001[0-9]7/.exec(b),"avc1."+(c&&c[0]?b.substr(b.indexOf(c[0])+10,6):void 0)}function g(a,b){var c=parseInt(a.getAttribute("SamplingRate"),10),d=a.getAttribute("CodecPrivateData").toString(),e=0,f=void 0,g=void 0,h=void 0,i=void 0;return"AACH"===b&&(e=5),void 0===d||""===d?(e=2,h=B[c],"AACH"===b?(e=5,d=new Uint8Array(4),i=B[2*c],d[0]=e<<3|h>>1,d[1]=h<<7|a.Channels<<3|i>>1,d[2]=i<<7|8,d[3]=0,g=new Uint16Array(2),g[0]=(d[0]<<8)+d[1],g[1]=(d[2]<<8)+d[3],f=g[0].toString(16),f=g[0].toString(16)+g[1].toString(16)):(d=new Uint8Array(2),d[0]=e<<3|h>>1,d[1]=h<<7|parseInt(a.getAttribute("Channels"),10)<<3,g=new Uint16Array(1),g[0]=(d[0]<<8)+d[1],f=g[0].toString(16)),d=""+f,d=d.toUpperCase(),a.setAttribute("CodecPrivateData",d)):0===e&&(e=(248&parseInt(d.substr(0,2),16))>>3),"mp4a.40."+e}function h(a,b){var c={},d=void 0,e=void 0;return d=a.getAttribute("Url").replace("{bitrate}","$Bandwidth$"),d=d.replace("{start time}","$Time$"),e=a.getAttribute("TimeScale"),e=e?parseFloat(e):b,c.media=d,c.timescale=e,c.SegmentTimeline=i(a,c.timescale),c}function i(a,b){var c={},d=a.getElementsByTagName("c"),e=[],f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=0;for(i=0;i<d.length;i++)if(f={},h=d[i].getAttribute("t"),f.tManifest=parseFloat(h),f.t=parseFloat(h),f.d=parseFloat(d[i].getAttribute("d")),0!==i||f.t||(f.t=0),i>0&&(g=e[e.length-1],g.d||(g.tManifest?g.d=parseFloat(h)-parseFloat(g.tManifest):g.d=f.t-g.t),f.t||(g.tManifest?(f.tManifest=parseFloat(g.tManifest)+g.d,f.t=parseFloat(f.tManifest)):f.t=g.t+g.d)),l+=f.d,e.push(f),k=parseFloat(d[i].getAttribute("r")))for(j=0;j<k-1;j++)g=e[e.length-1],f={},f.t=g.t+g.d,f.d=g.d,g.tManifest&&(f.tManifest=parseFloat(g.tManifest)+g.d),l+=f.d,e.push(f);return c.S=e,c.S_asArray=e,c.duration=l/b,c}function j(a){var b=void 0,c=void 0,d=void 0,e=void 0;return b=u.decodeArray(a.firstChild.data),c=k(b),c=new Uint16Array(c.buffer),c=String.fromCharCode.apply(null,c),d=(new DOMParser).parseFromString(c,"application/xml"),e=d.querySelector("KID").textContent,e=u.decodeArray(e),l(e),e}function k(a){var b=void 0,c=void 0,d=void 0,e=0;for((a[e+3]<<24)+(a[e+2]<<16)+(a[e+1]<<8)+a[e],e+=4,(a[e+1]<<8)+a[e],e+=2;e<a.length;)if(b=(a[e+1]<<8)+a[e],e+=2,1===b)return c=(a[e+1]<<8)+a[e],e+=2,d=new Uint8Array(c),d.set(a.subarray(e,e+c)),d;return null}function l(a){m(a,0,3),m(a,1,2),m(a,4,5),m(a,6,7)}function m(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function n(a){var b={__text:a.firstChild.data,__prefix:"mspr"};return{schemeIdUri:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",value:"com.microsoft.playready",pro:b,pro_asArray:b}}function o(a,b){var c=new Uint8Array(2+b.length);c[0]=18,c[1]=16,c.set(b,2);var d=32+c.length,e=new Uint8Array(d),f=0;return e[f++]=(4278190080&d)>>24,e[f++]=(16711680&d)>>16,e[f++]=(65280&d)>>8,e[f++]=255&d,e.set([112,115,115,104,0,0,0,0],f),f+=8,e.set([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],f),f+=16,e[f++]=(4278190080&c.length)>>24,e[f++]=(16711680&c.length)>>16,e[f++]=(65280&c.length)>>8,e[f++]=255&c.length,e.set(c,f),e=String.fromCharCode.apply(null,e),e=u.encodeASCII(e),{schemeIdUri:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",value:"com.widevine.alpha",pssh:{__text:e}}}function p(a,b){var d={},e=[],f=a.getElementsByTagName("SmoothStreamingMedia")[0],g=a.getElementsByTagName("Protection")[0],h=null,i=void 0,k=void 0,l=void 0,m=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0;for(d.protocol="MSS",d.profiles="urn:mpeg:dash:profile:isoff-live:2011",d.type="TRUE"===f.getAttribute("IsLive")?"dynamic":"static",s=f.getAttribute("TimeScale"),d.timescale=s?parseFloat(s):x,d.timeShiftBufferDepth=parseFloat(f.getAttribute("DVRWindowLength"))/d.timescale,d.mediaPresentationDuration=0===parseFloat(f.getAttribute("Duration"))?1/0:parseFloat(f.getAttribute("Duration"))/d.timescale,d.minBufferTime=F.getStableBufferTime(),d.ttmlTimeIsRelative=!0,"dynamic"===d.type&&(d.availabilityStartTime=new Date(b.getTime()-1e3*d.timeShiftBufferDepth),d.refreshManifestOnSwitchTrack=!0,d.doNotUpdateDVRWindowOnBufferUpdated=!0,d.ignorePostponeTimePeriod=!0),d.Period=c(f,d.timescale),d.Period_asArray=[d.Period],i=d.Period,i.start=0,void 0!==g&&(h=a.getElementsByTagName("ProtectionHeader")[0],h.firstChild.data=h.firstChild.data.replace(/\n|\r/g,""),m=j(h),l=n(h),l["cenc:default_KID"]=m,e.push(l),l=o(h,m),l["cenc:default_KID"]=m,e.push(l),d.ContentProtection=e,d.ContentProtection_asArray=e),k=i.AdaptationSet_asArray,t=0;t<k.length;t+=1)k[t].SegmentTemplate.initialization="$Bandwidth$",void 0!==d.ContentProtection&&(k[t].ContentProtection=d.ContentProtection,k[t].ContentProtection_asArray=d.ContentProtection_asArray),"dynamic"===d.type&&d.timeShiftBufferDepth>0&&"video"===k[t].contentType&&d.timeShiftBufferDepth>k[t].SegmentTemplate.SegmentTimeline.duration&&(d.timeShiftBufferDepth=k[t].SegmentTemplate.SegmentTimeline.duration);if(d.timeShiftBufferDepth<d.minBufferTime&&(d.minBufferTime=d.timeShiftBufferDepth),delete d.ContentProtection,delete d.ContentProtection_asArray,"static"===d.type){for(t=0;t<k.length;t++)"audio"!==k[t].contentType&&"video"!==k[t].contentType||(r=k[t].SegmentTemplate.SegmentTimeline.S_asArray,q=r[0].t/k[t].SegmentTemplate.timescale,void 0===p&&(p=q),p=Math.min(p,q),d.mediaPresentationDuration=Math.min(d.mediaPresentationDuration,k[t].SegmentTemplate.SegmentTimeline.duration));if(p>0){for(t=0;t<k.length;t++){for(r=k[t].SegmentTemplate.SegmentTimeline.S_asArray,u=0;u<r.length;u++)r[u].tManifest||(r[u].tManifest=r[u].t),r[u].t-=p*k[t].SegmentTemplate.timescale;"audio"!==k[t].contentType&&"video"!==k[t].contentType||(i.start=Math.max(r[0].t,i.start),k[t].SegmentTemplate.presentationTimeOffset=i.start)}i.start/=d.timescale}}return d.mediaPresentationDuration=Math.floor(1e3*d.mediaPresentationDuration)/1e3,i.duration=d.mediaPresentationDuration,d}function q(a){var b=null;if(window.DOMParser){if(b=(new window.DOMParser).parseFromString(a,"text/xml"),b.getElementsByTagName("parsererror").length>0)throw new Error("parsing the manifest failed")}return b}function r(){return null}function s(){return null}function t(a){var b=null,c=null,d=window.performance.now();b=q(a);var e=window.performance.now();if(null===b)return null;c=p(b,new Date);var f=window.performance.now();return E.info("Parsing complete: (xmlParsing: "+(e-d).toPrecision(3)+"ms, mss2dash: "+(f-e).toPrecision(3)+"ms, total: "+((f-d)/1e3).toPrecision(3)+"s)"),c}a=a||{};var u=a.BASE64,v=a.debug,w=a.constants,x=1e7,y=["AAC","AACL","AVC1","H264","TTML","DFXP"],z={SUBT:"alternate",CAPT:"alternate",DESC:"main"},A={DESC:"2"},B={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},C={video:"video/mp4",audio:"audio/mp4",text:"application/mp4"},D=void 0,E=void 0,F=void 0;return D={parse:t,getMatchers:r,getIron:s},b(),D}Object.defineProperty(c,"__esModule",{value:!0}),d.__dashjs_factory_name="MssParser",c.default=dashjs.FactoryMaker.getClassFactory(d),b.exports=c.default},{}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(){d(this,a),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};c.default=e,b.exports=c.default},{}],11:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function a(){d(this,a),this.action=a.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,
this.responseType="arraybuffer",this.representationId=null};e.ACTION_DOWNLOAD="download",e.ACTION_COMPLETE="complete",c.default=e,b.exports=c.default},{}]},{},[8]);
//# sourceMappingURL=dash.mss.min.js.map